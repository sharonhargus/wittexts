(function(n){n.parser("parseXML","XML",function(k){var m={title:"",remote:"",data:[]},g={},c=function(a){a=a.split(":");if(a.length===1)return parseFloat(a[0],10);else if(a.length===2)return parseFloat(a[0],10)+parseFloat(a[1]/12,10);else if(a.length===3)return parseInt(a[0]*60,10)+parseFloat(a[1],10)+parseFloat(a[2]/12,10);else if(a.length===4)return parseInt(a[0]*3600,10)+parseInt(a[1]*60,10)+parseFloat(a[2],10)+parseFloat(a[3]/12,10)},i=function(a){for(var d={},h=0,l=a.length;h<l;h++){var o=a.item(h).nodeName,
p=a.item(h).nodeValue,r=g[p];if(o==="in")d.start=c(p);else if(o==="out")d.end=c(p);else if(o==="resourceid")for(var q in r){if(r.hasOwnProperty(q))if(!d[q]&&q!=="id")d[q]=r[q]}else d[o]=p}return d},j=function(a,d){var h={};h[a]=d;return h},b=function(a,d,h){var l={};n.extend(l,d,i(a.attributes),{text:a.textContent||a.text});d=a.childNodes;if(d.length<1||d.length===1&&d[0].nodeType===3)if(h)g[l.id]=l;else m.data.push(j(a.nodeName,l));else for(a=0;a<d.length;a++)d[a].nodeType===1&&b(d[a],l,h)};k=k.documentElement.childNodes;
for(var e=0,f=k.length;e<f;e++)if(k[e].nodeType===1)k[e].nodeName==="manifest"?b(k[e],{},true):b(k[e],{},false);return m})})(Popcorn);(function(n){n.parser("parseSBV",function(k){var m={title:"",remote:"",data:[]},g=[],c=0,i=0,j=function(h){h=h.split(":");var l=h.length-1,o;try{o=parseInt(h[l-1],10)*60+parseFloat(h[l],10);if(l===2)o+=parseInt(h[0],10)*3600}catch(p){throw"Bad cue";}return o},b=function(h,l){var o={};o[h]=l;return o};k=k.text.split(/(?:\r\n|\r|\n)/gm);for(i=k.length;c<i;){var e={},f=[],a=k[c++].split(",");try{e.start=j(a[0]);for(e.end=j(a[1]);c<i&&k[c];)f.push(k[c++]);e.text=f.join("<br />");g.push(b("subtitle",e))}catch(d){for(;c<
i&&k[c];)c++}for(;c<i&&!k[c];)c++}m.data=g;return m})})(Popcorn);(function(n){n.parser("parseJSON","JSON",function(k){var m={title:"",remote:"",data:[]};n.forEach(k.data,function(g){m.data.push(g)});return m})})(Popcorn);(function(n){n.parser("parseTTXT",function(k){var m={title:"",remote:"",data:[]},g=function(e){e=e.split(":");var f=0;try{return parseFloat(e[0],10)*60*60+parseFloat(e[1],10)*60+parseFloat(e[2],10)}catch(a){f=0}return f},c=function(e,f){var a={};a[e]=f;return a};k=k.xml.lastChild.lastChild;for(var i=Number.MAX_VALUE,j=[];k;){if(k.nodeType===1&&k.nodeName==="TextSample"){var b={};b.start=g(k.getAttribute("sampleTime"));b.text=k.getAttribute("text");if(b.text){b.end=i-0.0010;j.push(c("subtitle",b))}i=
b.start}k=k.previousSibling}m.data=j.reverse();return m})})(Popcorn);(function(n){function k(b,e,f){var a=b.firstChild;b=m(b,f);f=[];for(var d;a;){if(a.nodeType===1)if(a.nodeName==="p")f.push(g(a,e,b));else if(a.nodeName==="div"){d=c(a.getAttribute("begin"));if(d<0)d=e;f.push.apply(f,k(a,d,b))}a=a.nextSibling}return f}function m(b,e){var f=b.getAttribute("region");return f!==null?f:e||""}function g(b,e,f){var a={};a.text=(b.textContent||b.text).replace(i,"").replace(j,"<br />");a.id=b.getAttribute("xml:id")||b.getAttribute("id");a.start=c(b.getAttribute("begin"),e);
a.end=c(b.getAttribute("end"),e);a.target=m(b,f);if(a.end<0){a.end=c(b.getAttribute("duration"),0);if(a.end>=0)a.end+=a.start;else a.end=Number.MAX_VALUE}return{subtitle:a}}function c(b,e){var f;if(!b)return-1;try{return n.util.toSeconds(b)}catch(a){for(var d=b.length-1;d>=0&&b[d]<="9"&&b[d]>="0";)d--;f=d;d=parseFloat(b.substring(0,f));f=b.substring(f);return d*({h:3600,m:60,s:1,ms:0.0010}[f]||-1)+(e||0)}}var i=/^[\s]+|[\s]+$/gm,j=/(?:\r\n|\r|\n)/gm;n.parser("parseTTML",function(b){var e={title:"",
remote:"",data:[]};if(!b.xml||!b.xml.documentElement)return e;b=b.xml.documentElement.firstChild;if(!b)return e;for(;b.nodeName!=="body";)b=b.nextSibling;if(b)e.data=k(b,0);return e})})(Popcorn);(function(n){function k(g){var c=g.split(":");g=g.length;var i;if(g!==12&&g!==9)throw"Bad cue";g=c.length-1;try{i=parseInt(c[g-1],10)*60+parseFloat(c[g],10);if(g===2)i+=parseInt(c[0],10)*3600}catch(j){throw"Bad cue";}return i}function m(g,c){var i={};i[g]=c;return i}n.parser("parseVTT",function(g){var c={title:"",remote:"",data:[]},i=[],j=0,b=0,e,f;g=g.text.split(/(?:\r\n|\r|\n)/gm);b=g.length;if(b===0||g[0]!=="WEBVTT")return c;for(j++;j<b;){e=[];try{for(var a=j;a<b&&!g[a];)a++;j=a;var d=g[j++];a=
void 0;var h={};if(!d||d.indexOf("--\>")===-1)throw"Bad cue";a=d.replace(/--\>/," --\> ").split(/[\t ]+/);if(a.length<2)throw"Bad cue";h.id=d;h.start=k(a[0]);h.end=k(a[2]);for(f=h;j<b&&g[j];)e.push(g[j++]);f.text=e.join("<br />");i.push(m("subtitle",f))}catch(l){for(j=j;j<b&&g[j];)j++;j=j}}c.data=i;return c})})(Popcorn);(function(n){function k(c,i){var j=c.substr(10).split(","),b;b={start:m(j[i.start]),end:m(j[i.end])};if(b.start===-1||b.end===-1)throw"Invalid time";var e=h.call(a,/\{(\\[\w]+\(?([\w\d]+,?)+\)?)+\}/gi,""),f=e.replace,a;a=j.length;h=[];for(var d=i.text;d<a;d++)h.push(j[d]);a=h.join(",");var h=a.replace;b.text=f.call(e,/\\N/gi,"<br />");return b}function m(c){var i=c.split(":");if(c.length!==10||i.length<3)return-1;return parseInt(i[0],10)*3600+parseInt(i[1],10)*60+parseFloat(i[2],10)}function g(c,
i){var j={};j[c]=i;return j}n.parser("parseSSA",function(c){var i={title:"",remote:"",data:[]},j=[],b=0,e;c=c.text.split(/(?:\r\n|\r|\n)/gm);for(e=c.length;b<e&&c[b]!=="[Events]";)b++;var f=c[++b].substr(8).split(", "),a={},d,h;h=0;for(d=f.length;h<d;h++)if(f[h]==="Start")a.start=h;else if(f[h]==="End")a.end=h;else if(f[h]==="Text")a.text=h;for(;++b<e&&c[b]&&c[b][0]!=="[";)try{j.push(g("subtitle",k(c[b],a)))}catch(l){}i.data=j;return i})})(Popcorn);(function(n){function k(g,c){var i={};i[g]=c;return i}function m(g){g=g.split(":");try{var c=g[2].split(",");if(c.length===1)c=g[2].split(".");return parseFloat(g[0],10)*3600+parseFloat(g[1],10)*60+parseFloat(c[0],10)+parseFloat(c[1],10)/1E3}catch(i){return 0}}n.parser("parseSRT",function(g,c){var i={title:"",remote:"",data:[]},j=[],b=0,e=0,f,a,d,h,l;f=g.text.split(/(?:\r\n|\r|\n)/gm);for(d=f.length-1;d>=0&&!f[d];)d--;h=d+1;for(b=0;b<h;b++){l={};d=[];for(b=b;!f[b];)b++;b=b;l.id=parseInt(f[b++],10);
a=f[b++].split(/[\t ]*--\>[\t ]*/);l.start=m(a[0]);e=a[1].indexOf(" ");if(e!==-1)a[1]=a[1].substr(0,e);for(l.end=m(a[1]);b<h&&f[b];)d.push(f[b++]);l.text=d.join("\\N").replace(/\{(\\[\w]+\(?([\w\d]+,?)+\)?)+\}/gi,"");l.text=l.text.replace(/</g,"&lt;").replace(/>/g,"&gt;");l.text=l.text.replace(/&lt;(\/?(font|b|u|i|s))((\s+(\w|\w[\w\-]*\w)(\s*=\s*(?:\".*?\"|'.*?'|[^'\">\s]+))?)+\s*|\s*)(\/?)&gt;/gi,"<$1$3$7>");l.text=l.text.replace(/\\N/gi,"<br />");if(c&&c.target)l.target=c.target;j.push(k("subtitle",
l))}i.data=j;return i})})(Popcorn);
