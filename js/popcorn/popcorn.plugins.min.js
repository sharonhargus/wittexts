(function(j){function d(b,a){if(b.map)b.map.div.style.display=a;else setTimeout(function(){d(b,a)},10)}var f=1;j.plugin("openmap",function(b){var a,c,e,g,h,l,n,o,m=document.getElementById(b.target);a=document.createElement("div");a.id="openmapdiv"+f;a.style.width="100%";a.style.height="100%";f++;m&&m.appendChild(a);o=function(){if(window.OpenLayers&&window.OpenLayers.Layer.Stamen){if(b.location){location=new OpenLayers.LonLat(0,0);j.getJSONP("//tinygeocoder.com/create-api.php?q="+b.location+"&callback=jsonp",
function(k){c=new OpenLayers.LonLat(k[1],k[0])})}else c=new OpenLayers.LonLat(b.lng,b.lat);b.type=b.type||"ROADMAP";switch(b.type){case "SATELLITE":b.map=new OpenLayers.Map({div:a,maxResolution:0.28125,tileSize:new OpenLayers.Size(512,512)});var i=new OpenLayers.Layer.WorldWind("LANDSAT","//worldwind25.arc.nasa.gov/tile/tile.aspx",2.25,4,{T:"105"});b.map.addLayer(i);g=new OpenLayers.Projection("EPSG:4326");e=new OpenLayers.Projection("EPSG:4326");break;case "TERRAIN":g=new OpenLayers.Projection("EPSG:4326");
e=new OpenLayers.Projection("EPSG:4326");b.map=new OpenLayers.Map({div:a,projection:e});i=new OpenLayers.Layer.WMS("USGS Terraserver","//terraserver-usa.org/ogcmap.ashx?",{layers:"DRG"});b.map.addLayer(i);break;case "STAMEN-TONER":case "STAMEN-WATERCOLOR":case "STAMEN-TERRAIN":i=b.type.replace("STAMEN-","").toLowerCase();i=new OpenLayers.Layer.Stamen(i);g=new OpenLayers.Projection("EPSG:4326");e=new OpenLayers.Projection("EPSG:900913");c=c.transform(g,e);b.map=new OpenLayers.Map({div:a,projection:e,
displayProjection:g,controls:[new OpenLayers.Control.Navigation,new OpenLayers.Control.PanPanel,new OpenLayers.Control.ZoomPanel]});b.map.addLayer(i);break;default:e=new OpenLayers.Projection("EPSG:900913");g=new OpenLayers.Projection("EPSG:4326");c=c.transform(g,e);b.map=new OpenLayers.Map({div:a,projection:e,displayProjection:g});i=new OpenLayers.Layer.OSM;b.map.addLayer(i)}if(b.map){b.map.setCenter(c,b.zoom||10);b.map.div.style.display="none"}}else setTimeout(function(){o()},50)};o();return{_setup:function(i){window.OpenLayers||
j.getScript("//openlayers.org/api/OpenLayers.js",function(){j.getScript("//maps.stamen.com/js/tile.stamen.js")});var k=function(){if(i.map){i.zoom=i.zoom||2;if(i.zoom&&typeof i.zoom!=="number")i.zoom=+i.zoom;i.map.setCenter(c,i.zoom);if(i.markers){var u=OpenLayers.Util.extend({},OpenLayers.Feature.Vector.style["default"]),s=function(q){clickedFeature=q.feature;if(clickedFeature.attributes.text){n=new OpenLayers.Popup.FramedCloud("featurePopup",clickedFeature.geometry.getBounds().getCenterLonLat(),
new OpenLayers.Size(120,250),clickedFeature.attributes.text,null,true,function(){l.unselect(this.feature)});clickedFeature.popup=n;n.feature=clickedFeature;i.map.addPopup(n)}},A=function(q){feature=q.feature;if(feature.popup){n.feature=null;i.map.removePopup(feature.popup);feature.popup.destroy();feature.popup=null}},x=function(q){j.getJSONP("//tinygeocoder.com/create-api.php?q="+q.location+"&callback=jsonp",function(p){p=(new OpenLayers.Geometry.Point(p[1],p[0])).transform(g,e);var v=OpenLayers.Util.extend({},
u);if(!q.size||isNaN(q.size))q.size=14;v.pointRadius=q.size;v.graphicOpacity=1;v.externalGraphic=q.icon;p=new OpenLayers.Feature.Vector(p,null,v);if(q.text)p.attributes={text:q.text};h.addFeatures([p])})};h=new OpenLayers.Layer.Vector("Point Layer",{style:u});i.map.addLayer(h);for(var y=0,C=i.markers.length;y<C;y++){var r=i.markers[y];if(r.text)if(!l){l=new OpenLayers.Control.SelectFeature(h);i.map.addControl(l);l.activate();h.events.on({featureselected:s,featureunselected:A})}if(r.location)x(r);
else{var D=(new OpenLayers.Geometry.Point(r.lng,r.lat)).transform(g,e),B=OpenLayers.Util.extend({},u);if(!r.size||isNaN(r.size))r.size=14;B.pointRadius=r.size;B.graphicOpacity=1;B.externalGraphic=r.icon;D=new OpenLayers.Feature.Vector(D,null,B);if(r.text)D.attributes={text:r.text};h.addFeatures([D])}}}}else setTimeout(function(){k()},13)};k()},start:function(i,k){d(k,"block")},end:function(i,k){d(k,"none")},_teardown:function(){m&&m.removeChild(a);a=map=c=e=g=h=l=n=null}}},{about:{name:"Popcorn OpenMap Plugin",
version:"0.3",author:"@mapmeld",website:"mapadelsur.blogspot.com"},options:{start:{elem:"input",type:"number",label:"Start"},end:{elem:"input",type:"number",label:"End"},target:"map-container",type:{elem:"select",options:["ROADMAP","SATELLITE","TERRAIN"],label:"Map Type",optional:true},zoom:{elem:"input",type:"number",label:"Zoom","default":2},lat:{elem:"input",type:"text",label:"Lat",optional:true},lng:{elem:"input",type:"text",label:"Lng",optional:true},location:{elem:"input",type:"text",label:"Location",
"default":"Toronto, Ontario, Canada"},markers:{elem:"input",type:"text",label:"List Markers",optional:true}}})})(Popcorn);var wikiCallback;
(function(j){j.plugin("wikipedia",{manifest:{about:{name:"Popcorn Wikipedia Plugin",version:"0.1",author:"@annasob",website:"annasob.wordpress.com"},options:{start:{elem:"input",type:"number",label:"Start"},end:{elem:"input",type:"number",label:"End"},lang:{elem:"input",type:"text",label:"Language","default":"english",optional:true},src:{elem:"input",type:"url",label:"Wikipedia URL","default":"http://en.wikipedia.org/wiki/Cat"},title:{elem:"input",type:"text",label:"Title","default":"Cats",optional:true},
numberofwords:{elem:"input",type:"number",label:"Number of Words","default":"200",optional:true},target:"wikipedia-container"}},_setup:function(d){var f,b=j.guid();if(!d.lang)d.lang="en";d.numberofwords=d.numberofwords||200;window["wikiCallback"+b]=function(a){d._link=document.createElement("a");d._link.setAttribute("href",d.src);d._link.setAttribute("target","_blank");d._link.innerHTML=d.title||a.parse.displaytitle;d._desc=document.createElement("p");f=a.parse.text["*"].substr(a.parse.text["*"].indexOf("<p>"));
f=f.replace(/((<(.|\n)+?>)|(\((.*?)\) )|(\[(.*?)\]))/g,"");f=f.split(" ");d._desc.innerHTML=f.slice(0,f.length>=d.numberofwords?d.numberofwords:f.length).join(" ")+" ...";d._fired=true};d.src&&j.getScript("//"+d.lang+".wikipedia.org/w/api.php?action=parse&props=text&redirects&page="+d.src.slice(d.src.lastIndexOf("/")+1)+"&format=json&callback=wikiCallback"+b);d.toString=function(){return d.src||d._natives.manifest.options.src["default"]}},start:function(d,f){var b=function(){if(f._fired){if(f._link&&
f._desc)if(document.getElementById(f.target)){document.getElementById(f.target).appendChild(f._link);document.getElementById(f.target).appendChild(f._desc);f._added=true}}else setTimeout(function(){b()},13)};b()},end:function(d,f){if(f._added){document.getElementById(f.target).removeChild(f._link);document.getElementById(f.target).removeChild(f._desc)}},_teardown:function(d){if(d._added){d._link.parentNode&&document.getElementById(d.target).removeChild(d._link);d._desc.parentNode&&document.getElementById(d.target).removeChild(d._desc);
delete d.target}}})})(Popcorn);(function(j){var d=0,f=function(b,a){var c=b.container=document.createElement("div"),e=c.style,g=b.media,h=function(){var l=b.position();e.fontSize="18px";e.width=g.offsetWidth+"px";e.top=l.top+g.offsetHeight-c.offsetHeight-40+"px";e.left=l.left+"px";setTimeout(h,10)};c.id=a||j.guid();e.position="absolute";e.color="white";e.textShadow="black 2px 2px 6px";e.fontWeight="bold";e.textAlign="center";h();b.media.parentNode.appendChild(c);return c};j.plugin("subtitle",{manifest:{about:{name:"Popcorn Subtitle Plugin",
version:"0.1",author:"Scott Downe",website:"http://scottdowne.wordpress.com/"},options:{start:{elem:"input",type:"text",label:"Start"},end:{elem:"input",type:"text",label:"End"},target:"subtitle-container",text:{elem:"input",type:"text",label:"Text"}}},_setup:function(b){var a=document.createElement("div");a.id="subtitle-"+d++;a.style.display="none";!this.container&&(!b.target||b.target==="subtitle-container")&&f(this);b.container=b.target&&b.target!=="subtitle-container"?document.getElementById(b.target)||
f(this,b.target):this.container;document.getElementById(b.container.id)&&document.getElementById(b.container.id).appendChild(a);b.innerContainer=a;b.showSubtitle=function(){b.innerContainer.innerHTML=b.text||""}},start:function(b,a){a.innerContainer.style.display="inline";a.showSubtitle(a,a.text)},end:function(b,a){a.innerContainer.style.display="none";a.innerContainer.innerHTML=""},_teardown:function(b){b.container.removeChild(b.innerContainer)}})})(Popcorn);(function(j,d){var f={};j.plugin("documentcloud",{manifest:{about:{name:"Popcorn Document Cloud Plugin",version:"0.1",author:"@humphd, @ChrisDeCairos",website:"http://vocamus.net/dave"},options:{start:{elem:"input",type:"number",label:"Start"},end:{elem:"input",type:"number",label:"End"},target:"documentcloud-container",width:{elem:"input",type:"text",label:"Width",optional:true},height:{elem:"input",type:"text",label:"Height",optional:true},src:{elem:"input",type:"url",label:"PDF URL","default":"http://www.documentcloud.org/documents/70050-urbina-day-1-in-progress.html"},
preload:{elem:"input",type:"checkbox",label:"Preload","default":true},page:{elem:"input",type:"number",label:"Page Number",optional:true},aid:{elem:"input",type:"number",label:"Annotation Id",optional:true}}},_setup:function(b){function a(){function n(q){b._key=q.api.getId();b._changeView=function(p){b.aid?p.pageSet.showAnnotation(p.api.getAnnotation(b.aid)):p.api.setCurrentPage(b.page)}}function o(){f[b._key]={num:1,id:b._containerId};e.loaded=true}e.loaded=false;var m=b.url.replace(/\.html$/,".js"),
i=b.target,k=d.getElementById(i),u=d.createElement("div"),s=j.position(k),A=b.width||s.width;s=b.height||s.height;var x=b.sidebar||true,y=b.text||true,C=b.pdf||true,r=b.showAnnotations||true,D=b.zoom||700,B=b.search||true;if(!function(q){var p=false;j.forEach(e.viewers,function(v){if(v.api.getSchema().canonicalURL===q){n(v);v=f[b._key];b._containerId=v.id;v.num+=1;p=true;e.loaded=true}});return p}(b.url)){u.id=b._containerId=j.guid(i);i="#"+u.id;k.appendChild(u);g.trigger("documentready");e.load(m,
{width:A,height:s,sidebar:x,text:y,pdf:C,showAnnotations:r,zoom:D,search:B,container:i,afterLoad:b.page||b.aid?function(q){n(q);b._changeView(q);u.style.visibility="hidden";q.elements.pages.hide();o()}:function(q){n(q);o();u.style.visibility="hidden";q.elements.pages.hide()}})}}function c(){window.DV.loaded?a():setTimeout(c,25)}var e=window.DV=window.DV||{},g=this;if(e.loading)c();else{e.loading=true;e.recordHit="//www.documentcloud.org/pixel.gif";var h=d.createElement("link"),l=d.getElementsByTagName("head")[0];
h.rel="stylesheet";h.type="text/css";h.media="screen";h.href="//s3.documentcloud.org/viewer/viewer-datauri.css";l.appendChild(h);e.loaded=false;j.getScript("http://s3.documentcloud.org/viewer/viewer.js",function(){e.loading=false;a()})}b.toString=function(){return b.src||b._natives.manifest.options.src["default"]}},start:function(b,a){var c=d.getElementById(a._containerId),e=DV.viewers[a._key];(a.page||a.aid)&&e&&a._changeView(e);if(c&&e){c.style.visibility="visible";e.elements.pages.show()}},end:function(b,
a){var c=d.getElementById(a._containerId);if(c&&DV.viewers[a._key]){c.style.visibility="hidden";DV.viewers[a._key].elements.pages.hide()}},_teardown:function(b){var a=d.getElementById(b._containerId);if((b=b._key)&&DV.viewers[b]&&--f[b].num===0){for(DV.viewers[b].api.unload();a.hasChildNodes();)a.removeChild(a.lastChild);a.parentNode.removeChild(a)}}})})(Popcorn,window.document);(function(j){var d=/(?:http:\/\/www\.|http:\/\/|www\.|\.|^)(youtu|vimeo|soundcloud|baseplayer)/,f={},b={vimeo:false,youtube:false,soundcloud:false,module:false};Object.defineProperty(f,void 0,{get:function(){return b[void 0]},set:function(a){b[void 0]=a}});j.plugin("mediaspawner",{manifest:{about:{name:"Popcorn Media Spawner Plugin",version:"0.1",author:"Matthew Schranz, @mjschranz",website:"mschranz.wordpress.com"},options:{source:{elem:"input",type:"text",label:"Media Source","default":"http://www.youtube.com/watch?v=CXDstfD9eJ0"},
caption:{elem:"input",type:"text",label:"Media Caption","default":"Popcorn Popping",optional:true},target:"mediaspawner-container",start:{elem:"input",type:"number",label:"Start"},end:{elem:"input",type:"number",label:"End"},autoplay:{elem:"input",type:"checkbox",label:"Autoplay Video",optional:true},width:{elem:"input",type:"number",label:"Media Width","default":400,units:"px",optional:true},height:{elem:"input",type:"number",label:"Media Height","default":200,units:"px",optional:true}}},_setup:function(a){function c(){function o(){if(h!==
"HTML5"&&!window.Popcorn[h])setTimeout(function(){o()},300);else{a.id=a._container.id;a._container.style.width=a.width+"px";a._container.style.height=a.height+"px";a.popcorn=j.smart("#"+a.id,a.source);h==="HTML5"&&a.popcorn.controls(true);a._container.style.width="0px";a._container.style.height="0px";a._container.style.visibility="hidden";a._container.style.overflow="hidden"}}if(h!=="HTML5"&&!window.Popcorn[h]&&!f[h]){f[h]=true;j.getScript("http://popcornjs.org/code/players/"+h+"/popcorn."+h+".js",
function(){o()})}else o()}function e(){window.Popcorn.player?c():setTimeout(function(){e()},300)}var g=document.getElementById(a.target)||{},h,l,n;if(l=d.exec(a.source)){h=l[1];if(h==="youtu")h="youtube"}else h="HTML5";a._type=h;a._container=document.createElement("div");l=a._container;l.id="mediaSpawnerdiv-"+j.guid();a.width=a.width||400;a.height=a.height||200;if(a.caption){n=document.createElement("div");n.innerHTML=a.caption;n.style.display="none";a._capCont=n;l.appendChild(n)}g&&g.appendChild(l);
if(!window.Popcorn.player&&!f.module){f.module=true;j.getScript("http://popcornjs.org/code/modules/player/popcorn.player.js",e)}else e();a.toString=function(){return a.source||a._natives.manifest.options.source["default"]}},start:function(a,c){if(c._capCont)c._capCont.style.display="";c._container.style.width=c.width+"px";c._container.style.height=c.height+"px";c._container.style.visibility="visible";c._container.style.overflow="visible";c.autoplay&&c.popcorn.play()},end:function(a,c){if(c._capCont)c._capCont.style.display=
"none";c._container.style.width="0px";c._container.style.height="0px";c._container.style.visibility="hidden";c._container.style.overflow="hidden";c.popcorn.pause()},_teardown:function(a){a.popcorn&&a.popcorn.destory&&a.popcorn.destroy();document.getElementById(a.target)&&document.getElementById(a.target).removeChild(a._container)}})})(Popcorn,this);(function(j){var d=1;j.plugin("timeline",function(f){var b=document.getElementById(f.target),a=document.createElement("div"),c,e=true;if(b&&!b.firstChild){b.appendChild(c=document.createElement("div"));c.style.width="inherit";c.style.height="inherit";c.style.overflow="auto"}else c=b.firstChild;a.style.display="none";a.id="timelineDiv"+d;f.direction=f.direction||"up";if(f.direction.toLowerCase()==="down")e=false;if(b&&c)e?c.insertBefore(a,c.firstChild):c.appendChild(a);d++;a.innerHTML="<p><span id='big' style='font-size:24px; line-height: 130%;' >"+
f.title+"</span><br /><span id='mid' style='font-size: 16px;'>"+f.text+"</span><br />"+f.innerHTML;return{start:function(g,h){a.style.display="block";if(h.direction==="down")c.scrollTop=c.scrollHeight},end:function(){a.style.display="none"},_teardown:function(){c&&a&&c.removeChild(a)&&!c.firstChild&&b.removeChild(c)}}},{about:{name:"Popcorn Timeline Plugin",version:"0.1",author:"David Seifried @dcseifried",website:"dseifried.wordpress.com"},options:{start:{elem:"input",type:"number",label:"Start"},
end:{elem:"input",type:"number",label:"End"},target:"feed-container",title:{elem:"input",type:"text",label:"Title"},text:{elem:"input",type:"text",label:"Text"},innerHTML:{elem:"input",type:"text",label:"HTML Code",optional:true},direction:{elem:"select",options:["DOWN","UP"],label:"Direction",optional:true}}})})(Popcorn);(function(j){var d=0;j.plugin("flickr",function(f){var b,a=document.getElementById(f.target),c,e,g,h,l=f.numberofimages||4,n=f.height||"50px",o=f.width||"50px",m=f.padding||"5px",i=f.border||"0px";b=document.createElement("div");b.id="flickr"+d;b.style.width="100%";b.style.height="100%";b.style.display="none";d++;a&&a.appendChild(b);var k=function(){if(c)setTimeout(function(){k()},5);else{e="http://api.flickr.com/services/rest/?method=flickr.people.findByUsername&";e+="username="+f.username+"&api_key="+
f.apikey+"&format=json&jsoncallback=flickr";j.getJSONP(e,function(s){c=s.user.nsid;u()})}},u=function(){e="http://api.flickr.com/services/feeds/photos_public.gne?";if(c)e+="id="+c+"&";if(f.tags)e+="tags="+f.tags+"&";e+="lang=en-us&format=json&jsoncallback=flickr";j.xhr.getJSONP(e,function(s){var A=document.createElement("div");A.innerHTML="<p style='padding:"+m+";'>"+s.title+"<p/>";j.forEach(s.items,function(x,y){if(y<l){g=document.createElement("a");g.setAttribute("href",x.link);g.setAttribute("target",
"_blank");h=document.createElement("img");h.setAttribute("src",x.media.m);h.setAttribute("height",n);h.setAttribute("width",o);h.setAttribute("style","border:"+i+";padding:"+m);g.appendChild(h);A.appendChild(g)}else return false});b.appendChild(A)})};if(f.username&&f.apikey)k();else{c=f.userid;u()}f.toString=function(){return f.tags||f.username||"Flickr"};return{start:function(){b.style.display="inline"},end:function(){b.style.display="none"},_teardown:function(s){document.getElementById(s.target)&&
document.getElementById(s.target).removeChild(b)}}},{about:{name:"Popcorn Flickr Plugin",version:"0.2",author:"Scott Downe, Steven Weerdenburg, Annasob",website:"http://scottdowne.wordpress.com/"},options:{start:{elem:"input",type:"number",label:"Start"},end:{elem:"input",type:"number",label:"End"},userid:{elem:"input",type:"text",label:"User ID",optional:true},tags:{elem:"input",type:"text",label:"Tags"},username:{elem:"input",type:"text",label:"Username",optional:true},apikey:{elem:"input",type:"text",
label:"API Key",optional:true},target:"flickr-container",height:{elem:"input",type:"text",label:"Height","default":"50px",optional:true},width:{elem:"input",type:"text",label:"Width","default":"50px",optional:true},padding:{elem:"input",type:"text",label:"Padding",optional:true},border:{elem:"input",type:"text",label:"Border","default":"5px",optional:true},numberofimages:{elem:"input",type:"number","default":4,label:"Number of Images"}}})})(Popcorn);(function(j){j.plugin("webpage",{manifest:{about:{name:"Popcorn Webpage Plugin",version:"0.1",author:"@annasob",website:"annasob.wordpress.com"},options:{id:{elem:"input",type:"text",label:"Id",optional:true},start:{elem:"input",type:"number",label:"Start"},end:{elem:"input",type:"number",label:"End"},src:{elem:"input",type:"url",label:"Webpage URL","default":"http://mozillapopcorn.org"},target:"iframe-container"}},_setup:function(d){var f=document.getElementById(d.target);d.src=d.src.replace(/^(https?:)?(\/\/)?/,
"//");d._iframe=document.createElement("iframe");d._iframe.setAttribute("width","100%");d._iframe.setAttribute("height","100%");d._iframe.id=d.id;d._iframe.src=d.src;d._iframe.style.display="none";f&&f.appendChild(d._iframe)},start:function(d,f){f._iframe.src=f.src;f._iframe.style.display="inline"},end:function(d,f){f._iframe.style.display="none"},_teardown:function(d){document.getElementById(d.target)&&document.getElementById(d.target).removeChild(d._iframe)}})})(Popcorn);(function(j){var d={},f=0,b=document.createElement("span"),a=["webkit","Moz","ms","O",""],c=["Transform","TransitionDuration","TransitionTimingFunction"],e={},g;document.getElementsByTagName("head")[0].appendChild(b);for(var h=0,l=c.length;h<l;h++)for(var n=0,o=a.length;n<o;n++){g=a[n]+c[h];if(g in b.style){e[c[h].toLowerCase()]=g;break}}document.getElementsByTagName("head")[0].appendChild(b);j.plugin("wordriver",{manifest:{about:{name:"Popcorn WordRiver Plugin"},options:{start:{elem:"input",type:"number",
label:"Start"},end:{elem:"input",type:"number",label:"End"},target:"wordriver-container",text:{elem:"input",type:"text",label:"Text","default":"Popcorn.js"},color:{elem:"input",type:"text",label:"Color","default":"Green",optional:true}}},_setup:function(m){m._duration=m.end-m.start;var i;if(!(i=d[m.target])){i=m.target;d[i]=document.createElement("div");var k=document.getElementById(i);k&&k.appendChild(d[i]);d[i].style.height="100%";d[i].style.position="relative";i=d[i]}m._container=i;m.word=document.createElement("span");
m.word.style.position="absolute";m.word.style.whiteSpace="nowrap";m.word.style.opacity=0;m.word.style.MozTransitionProperty="opacity, -moz-transform";m.word.style.webkitTransitionProperty="opacity, -webkit-transform";m.word.style.OTransitionProperty="opacity, -o-transform";m.word.style.transitionProperty="opacity, transform";m.word.style[e.transitionduration]="1s, "+m._duration+"s";m.word.style[e.transitiontimingfunction]="linear";m.word.innerHTML=m.text;m.word.style.color=m.color||"black"},start:function(m,
i){i._container.appendChild(i.word);i.word.style[e.transform]="";i.word.style.fontSize=~~(30+20*Math.random())+"px";f%=i._container.offsetWidth-i.word.offsetWidth;i.word.style.left=f+"px";f+=i.word.offsetWidth+10;i.word.style[e.transform]="translateY("+(i._container.offsetHeight-i.word.offsetHeight)+"px)";i.word.style.opacity=1;setTimeout(function(){i.word.style.opacity=0},(i.end-i.start-1||1)*1E3)},end:function(m,i){i.word.style.opacity=0},_teardown:function(m){var i=document.getElementById(m.target);
m.word.parentNode&&m._container.removeChild(m.word);d[m.target]&&!d[m.target].childElementCount&&i&&i.removeChild(d[m.target])&&delete d[m.target]}})})(Popcorn);var googleCallback;
(function(j){function d(g,h,l){g=g.type?g.type.toUpperCase():"HYBRID";var n;if(g==="STAMEN-WATERCOLOR"||g==="STAMEN-TERRAIN"||g==="STAMEN-TONER")n=g.replace("STAMEN-","").toLowerCase();l=new google.maps.Map(l,{mapTypeId:n?n:google.maps.MapTypeId[g],mapTypeControlOptions:{mapTypeIds:[]}});n&&l.mapTypes.set(n,new google.maps.StamenMapType(n));l.getDiv().style.display="none";return l}var f=1,b=false,a=false,c,e;googleCallback=function(g){if(typeof google!=="undefined"&&google.maps&&google.maps.Geocoder&&
google.maps.LatLng){c=new google.maps.Geocoder;j.getScript("//maps.stamen.com/js/tile.stamen.js",function(){a=true})}else setTimeout(function(){googleCallback(g)},1)};e=function(){if(document.body){b=true;j.getScript("//maps.google.com/maps/api/js?sensor=false&callback=googleCallback")}else setTimeout(function(){e()},1)};j.plugin("googlemap",function(g){var h,l,n,o=document.getElementById(g.target);g.type=g.type||"ROADMAP";g.zoom=g.zoom||1;g.lat=g.lat||0;g.lng=g.lng||0;b||e();h=document.createElement("div");
h.id="actualmap"+f;h.style.width=g.width||"100%";h.style.height=g.height?g.height:o&&o.clientHeight?o.clientHeight+"px":"100%";f++;o&&o.appendChild(h);var m=function(){if(a){if(h)if(g.location)c.geocode({address:g.location},function(i,k){if(h&&k===google.maps.GeocoderStatus.OK){g.lat=i[0].geometry.location.lat();g.lng=i[0].geometry.location.lng();n=new google.maps.LatLng(g.lat,g.lng);l=d(g,n,h)}});else{n=new google.maps.LatLng(g.lat,g.lng);l=d(g,n,h)}}else setTimeout(function(){m()},5)};m();g.toString=
function(){return g.location||(g.lat&&g.lng?g.lat+", "+g.lng:g._natives.manifest.options.location["default"])};return{start:function(i,k){var u=this,s,A=function(){if(l){k._map=l;l.getDiv().style.display="block";google.maps.event.trigger(l,"resize");l.setCenter(n);if(k.zoom&&typeof k.zoom!=="number")k.zoom=+k.zoom;l.setZoom(k.zoom);if(k.heading&&typeof k.heading!=="number")k.heading=+k.heading;if(k.pitch&&typeof k.pitch!=="number")k.pitch=+k.pitch;if(k.type==="STREETVIEW"){l.setStreetView(s=new google.maps.StreetViewPanorama(h,
{position:n,pov:{heading:k.heading=k.heading||0,pitch:k.pitch=k.pitch||0,zoom:k.zoom}}));var x=function(p,v){var E=google.maps.geometry.spherical.computeHeading;setTimeout(function(){var z=u.media.currentTime;if(typeof k.tween==="object"){for(var t=0,F=p.length;t<F;t++){var w=p[t];if(z>=w.interval*(t+1)/1E3&&(z<=w.interval*(t+2)/1E3||z>=w.interval*F/1E3)){B.setPosition(new google.maps.LatLng(w.position.lat,w.position.lng));B.setPov({heading:w.pov.heading||E(w,p[t+1])||0,zoom:w.pov.zoom||0,pitch:w.pov.pitch||
0})}}x(p,p[0].interval)}else{t=0;for(F=p.length;t<F;t++){w=k.interval;if(z>=w*(t+1)/1E3&&(z<=w*(t+2)/1E3||z>=w*F/1E3)){y.setPov({heading:E(p[t],p[t+1])||0,zoom:k.zoom,pitch:k.pitch||0});y.setPosition(C[t])}}x(C,k.interval)}},v)};if(k.location&&typeof k.tween==="string"){var y=s,C=[],r=new google.maps.DirectionsService,D=new google.maps.DirectionsRenderer(y);r.route({origin:k.location,destination:k.tween,travelMode:google.maps.TravelMode.DRIVING},function(p,v){if(v==google.maps.DirectionsStatus.OK){D.setDirections(p);
for(var E=p.routes[0].overview_path,z=0,t=E.length;z<t;z++)C.push(new google.maps.LatLng(E[z].lat(),E[z].lng()));k.interval=k.interval||1E3;x(C,10)}})}else if(typeof k.tween==="object"){var B=s;r=0;for(var q=k.tween.length;r<q;r++){k.tween[r].interval=k.tween[r].interval||1E3;x(k.tween,10)}}}k.onmaploaded&&k.onmaploaded(k,l)}else setTimeout(function(){A()},13)};A()},end:function(){if(l)l.getDiv().style.display="none"},_teardown:function(i){var k=document.getElementById(i.target);k&&k.removeChild(h);
h=l=n=null;i._map=null}}},{about:{name:"Popcorn Google Map Plugin",version:"0.1",author:"@annasob",website:"annasob.wordpress.com"},options:{start:{elem:"input",type:"start",label:"Start"},end:{elem:"input",type:"start",label:"End"},target:"map-container",type:{elem:"select",options:["ROADMAP","SATELLITE","STREETVIEW","HYBRID","TERRAIN","STAMEN-WATERCOLOR","STAMEN-TERRAIN","STAMEN-TONER"],label:"Map Type",optional:true},zoom:{elem:"input",type:"text",label:"Zoom","default":0,optional:true},lat:{elem:"input",
type:"text",label:"Lat",optional:true},lng:{elem:"input",type:"text",label:"Lng",optional:true},location:{elem:"input",type:"text",label:"Location","default":"Toronto, Ontario, Canada"},heading:{elem:"input",type:"text",label:"Heading","default":0,optional:true},pitch:{elem:"input",type:"text",label:"Pitch","default":1,optional:true}}})})(Popcorn);(function(j){j.plugin("mustache",function(d){var f,b,a,c;j.getScript("http://mustache.github.com/extras/mustache.js");var e=!!d.dynamic,g=typeof d.template,h=typeof d.data,l=document.getElementById(d.target);d.container=l||document.createElement("div");if(g==="function")if(e)a=d.template;else c=d.template(d);else c=g==="string"?d.template:"";if(h==="function")if(e)f=d.data;else b=d.data(d);else b=h==="string"?JSON.parse(d.data):h==="object"?d.data:"";return{start:function(n,o){var m=function(){if(window.Mustache){if(f)b=
f(o);if(a)c=a(o);var i=Mustache.to_html(c,b).replace(/^\s*/mg,"");o.container.innerHTML=i}else setTimeout(function(){m()},10)};m()},end:function(n,o){o.container.innerHTML=""},_teardown:function(){f=b=a=c=null}}},{about:{name:"Popcorn Mustache Plugin",version:"0.1",author:"David Humphrey (@humphd)",website:"http://vocamus.net/dave"},options:{start:{elem:"input",type:"number",label:"Start"},end:{elem:"input",type:"number",label:"End"},target:"mustache-container",template:{elem:"input",type:"text",
label:"Template"},data:{elem:"input",type:"text",label:"Data"},dynamic:{elem:"input",type:"checkbox",label:"Dynamic","default":true}}})})(Popcorn);document.addEventListener("click",function(j){j=j.target;if(j.nodeName==="A"||j.parentNode&&j.parentNode.nodeName==="A")Popcorn.instances.forEach(function(d){d.options.pauseOnLinkClicked&&d.pause()})},false);(function(j){j.plugin("footnote",{manifest:{about:{name:"Popcorn Footnote Plugin",version:"0.2",author:"@annasob, @rwaldron",website:"annasob.wordpress.com"},options:{start:{elem:"input",type:"number",label:"Start"},end:{elem:"input",type:"number",label:"End"},text:{elem:"input",type:"text",label:"Text"},target:"footnote-container"}},_setup:function(d){var f=j.dom.find(d.target);d._container=document.createElement("div");d._container.style.display="none";d._container.innerHTML=d.text;f.appendChild(d._container)},
start:function(d,f){f._container.style.display="inline"},end:function(d,f){f._container.style.display="none"},_teardown:function(d){var f=j.dom.find(d.target);f&&f.removeChild(d._container)}})})(Popcorn);(function(j){var d=1,f=false;j.plugin("googlefeed",function(b){var a=function(){var h=false,l=0,n=document.getElementsByTagName("link"),o=n.length,m=document.head||document.getElementsByTagName("head")[0],i=document.createElement("link");if(window.GFdynamicFeedControl)f=true;else j.getScript("//www.google.com/uds/solutions/dynamicfeed/gfdynamicfeedcontrol.js",function(){f=true});for(;l<o;l++)if(n[l].href==="//www.google.com/uds/solutions/dynamicfeed/gfdynamicfeedcontrol.css")h=true;if(!h){i.type=
"text/css";i.rel="stylesheet";i.href="//www.google.com/uds/solutions/dynamicfeed/gfdynamicfeedcontrol.css";m.insertBefore(i,m.firstChild)}};window.google?a():j.getScript("//www.google.com/jsapi",function(){google.load("feeds","1",{callback:function(){a()}})});var c=document.createElement("div"),e=document.getElementById(b.target),g=function(){if(f)b.feed=new GFdynamicFeedControl(b.url,c,{vertical:b.orientation.toLowerCase()==="vertical"?true:false,horizontal:b.orientation.toLowerCase()==="horizontal"?
true:false,title:b.title=b.title||"Blog"});else setTimeout(function(){g()},5)};if(!b.orientation||b.orientation.toLowerCase()!=="vertical"&&b.orientation.toLowerCase()!=="horizontal")b.orientation="vertical";c.style.display="none";c.id="_feed"+d;c.style.width="100%";c.style.height="100%";d++;e&&e.appendChild(c);g();b.toString=function(){return b.url||b._natives.manifest.options.url["default"]};return{start:function(){c.setAttribute("style","display:inline")},end:function(){c.setAttribute("style",
"display:none")},_teardown:function(h){document.getElementById(h.target)&&document.getElementById(h.target).removeChild(c);delete h.feed}}},{about:{name:"Popcorn Google Feed Plugin",version:"0.1",author:"David Seifried",website:"dseifried.wordpress.com"},options:{start:{elem:"input",type:"number",label:"Start"},end:{elem:"input",type:"number",label:"End"},target:"feed-container",url:{elem:"input",type:"url",label:"Feed URL","default":"http://planet.mozilla.org/rss20.xml"},title:{elem:"input",type:"text",
label:"Title","default":"Planet Mozilla",optional:true},orientation:{elem:"select",options:["Vertical","Horizontal"],label:"Orientation","default":"Vertical",optional:true}}})})(Popcorn);(function(j){function d(a){return String(a).replace(/&(?!\w+;)|[<>"']/g,function(c){return b[c]||c})}function f(a,c){var e=a.container=document.createElement("div"),g=e.style,h=a.media,l=function(){var n=a.position();g.fontSize="18px";g.width=h.offsetWidth+"px";g.top=n.top+h.offsetHeight-e.offsetHeight-40+"px";g.left=n.left+"px";setTimeout(l,10)};e.id=c||"";g.position="absolute";g.color="white";g.textShadow="black 2px 2px 6px";g.fontWeight="bold";g.textAlign="center";l();a.media.parentNode.appendChild(e);
return e}var b={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"};j.plugin("text",{manifest:{about:{name:"Popcorn Text Plugin",version:"0.1",author:"@humphd"},options:{start:{elem:"input",type:"number",label:"Start"},end:{elem:"input",type:"number",label:"End"},text:{elem:"input",type:"text",label:"Text","default":"Popcorn.js"},escape:{elem:"input",type:"checkbox",label:"Escape"},multiline:{elem:"input",type:"checkbox",label:"Multiline"}}},_setup:function(a){var c,e,g=a._container=document.createElement("div");
g.style.display="none";if(a.target)if(c=j.dom.find(a.target)){if(["VIDEO","AUDIO"].indexOf(c.nodeName)>-1)c=f(this,a.target+"-overlay")}else c=f(this,a.target);else c=this.container?this.container:f(this);a._target=c;e=a.escape?d(a.text):a.text;e=a.multiline?e.replace(/\r?\n/gm,"<br>"):e;g.innerHTML=e||"";c.appendChild(g);a.toString=function(){return a.text||a._natives.manifest.options.text["default"]}},start:function(a,c){c._container.style.display="inline"},end:function(a,c){c._container.style.display=
"none"},_teardown:function(a){var c=a._target;c&&c.removeChild(a._container)}})})(Popcorn);(function(j){j.plugin("code",function(d){var f=false,b=this,a=function(){var c=function(e){return function(g,h){var l=function(){f&&g.call(b,h);f&&e(l)};l()}};return window.webkitRequestAnimationFrame?c(window.webkitRequestAnimationFrame):window.mozRequestAnimationFrame?c(window.mozRequestAnimationFrame):c(function(e){window.setTimeout(e,16)})}();if(!d.onStart||typeof d.onStart!=="function")d.onStart=j.nop;if(d.onEnd&&typeof d.onEnd!=="function")d.onEnd=undefined;if(d.onFrame&&typeof d.onFrame!==
"function")d.onFrame=undefined;return{start:function(c,e){e.onStart.call(b,e);if(e.onFrame){f=true;a(e.onFrame,e)}},end:function(c,e){if(e.onFrame)f=false;e.onEnd&&e.onEnd.call(b,e)}}},{about:{name:"Popcorn Code Plugin",version:"0.1",author:"David Humphrey (@humphd)",website:"http://vocamus.net/dave"},options:{start:{elem:"input",type:"number",label:"Start"},end:{elem:"input",type:"number",label:"End"},onStart:{elem:"input",type:"function",label:"onStart"},onFrame:{elem:"input",type:"function",label:"onFrame",
optional:true},onEnd:{elem:"input",type:"function",label:"onEnd"}}})})(Popcorn);(function(j){function d(a){function c(){var l=a.getBoundingClientRect(),n=g.getBoundingClientRect();if(n.left!==l.left)g.style.left=l.left+"px";if(n.top!==l.top)g.style.top=l.top+"px"}var e=-1,g=document.createElement("div"),h=getComputedStyle(a).zIndex;g.setAttribute("data-popcorn-helper-container",true);g.style.position="absolute";g.style.zIndex=isNaN(h)?f:h+1;document.body.appendChild(g);return{element:g,start:function(){e=setInterval(c,b)},stop:function(){clearInterval(e);e=-1},destroy:function(){document.body.removeChild(g);
e!==-1&&clearInterval(e)}}}var f=2E3,b=10;j.plugin("image",{manifest:{about:{name:"Popcorn image Plugin",version:"0.1",author:"Scott Downe",website:"http://scottdowne.wordpress.com/"},options:{start:{elem:"input",type:"number",label:"Start"},end:{elem:"input",type:"number",label:"End"},src:{elem:"input",type:"url",label:"Image URL","default":"http://mozillapopcorn.org/wp-content/themes/popcorn/images/for_developers.png"},href:{elem:"input",type:"url",label:"Link","default":"http://mozillapopcorn.org/wp-content/themes/popcorn/images/for_developers.png",
optional:true},target:"image-container",text:{elem:"input",type:"text",label:"Caption","default":"Popcorn.js",optional:true}}},_setup:function(a){var c=document.createElement("img"),e=document.getElementById(a.target);a.anchor=document.createElement("a");a.anchor.style.position="relative";a.anchor.style.textDecoration="none";a.anchor.style.display="none";if(e)if(["VIDEO","AUDIO"].indexOf(e.nodeName)>-1){a.trackedContainer=d(e);a.trackedContainer.element.appendChild(a.anchor)}else e&&e.appendChild(a.anchor);
c.addEventListener("load",function(){c.style.borderStyle="none";a.anchor.href=a.href||a.src||"#";a.anchor.target="_blank";var g,h;c.style.height=e.style.height;c.style.width=e.style.width;a.anchor.appendChild(c);if(a.text){g=c.height/12+"px";h=document.createElement("div");j.extend(h.style,{color:"black",fontSize:g,fontWeight:"bold",position:"relative",textAlign:"center",width:c.style.width||c.width+"px",zIndex:"10"});h.innerHTML=a.text||"";h.style.top=(c.style.height.replace("px","")||c.height)/
2-h.offsetHeight/2+"px";a.anchor.insertBefore(h,c)}},false);c.src=a.src;a.toString=function(){var g=a.src||a._natives.manifest.options.src["default"],h=g.replace(/.*\//g,"");return h.length?h:g}},start:function(a,c){c.anchor.style.display="inline";c.trackedContainer&&c.trackedContainer.start()},end:function(a,c){c.anchor.style.display="none";c.trackedContainer&&c.trackedContainer.stop()},_teardown:function(a){if(a.trackedContainer)a.trackedContainer.destroy();else a.anchor.parentNode&&a.anchor.parentNode.removeChild(a.anchor)}})})(Popcorn);
